# Оформление javascript кода
###### Редакция 1 от 07 нояб. 2015
------
Данный документ содержит предложения по оформлению javascript кода в соответствии с приведенными ниже соглашениями, разработанными на базе работы [Felix Geisendörfer](http://felixge.de/) лицензированной под [CC BY-SA 3.0](http://creativecommons.org/licenses/by-sa/3.0/).

## Содержание
* [4 пробельных символа для отступов](#4-пробельных-символа-для-отступов)
* [Переходы на новую строку](#Переходы-на-новую-строку)
* [Избыточные пробельные символы](#Избыточные-пробельные-символы)
* [Максимальная длина строки](#Максимальная-длина-строки)
* [Использование одинарных кавычек](#Использование-одинарных-кавычек)
* [Открытие фигурных скобок без переноса](#Открытие-фигурных-скобок-без-переноса)
* [Объявление переменных с новой строки](#Объявление-переменных-с-новой-строки)
* [Оформление массивов и объектов](#Оформление-массивов-и-объектов)
* [Операторы сравнения](#Операторы-сравнения)
* [Использование описательных условий](#Использование-описательных-условий)
* [Цепочка методов](#Цепочка-методов)

### 4 пробельных символа для отступов
**Резрешено:** Использовать только 4 пробельных символа для оступов.
**Запрещено:** Использовать символ табуляции в качестве любого оступа

### Переходы на новую строку
Резрешено использовать только UNIX подобные переходы (`\n`), использование Windows подобных переходов (`\r\n`) строго запрещено.

### Избыточные пробельные символы
Предлагается следить за остаточными пробельными символами (в конце строки в частности).
Это позволит повысить читаемость кода, а также является показателем "чистоплотности" автора.

### Максимальная длина строки
Строки кода не должны выходить за пределы печатного пространства. (оно отображается линией, при работе в таких IDE как: PhpStorm, WebStorm).
Это улучшает читаемость и поддержку Вашего кода.

### Использование одинарных кавычек
Разрешено использование только одинарных кавычек, за исключением JSON файлов.

*Разрешено:*

```js
var foo = 'bar';
var bar = foo + '_static';
console.info('value: ', foo);
```

*Запрещено:*

```js
var foo = "bar";
var bar = foo + "_static";
console.info("value: ", foo);
```

### Открытие фигурных скобок без переноса
Фигурные скобки должны открываться на той же строке, где и само утверждение.

*Разрешено:*

```js
if (true) {
....console.log('right');
}
```

*Запрещено:*

```js
if (true)
{
..console.log("wrong");
}
```

Обратите внимание на использование проблеьных символов и одинарных кавычек.

### Объявление переменных с новой строки
Рвзрешено объявлять переменные каждую на новой строке. Это сделает чтение кода проще, а также перегруппировать строки легче. Однако, если небоходимо объявить переменные внутри фнукции, это стоить делать только в том случае, если они действительно оправданы.

*Разрешено:*

```js
var keys   = ['foo', 'bar'];
var values = [23, 42];

var object = {};
while (keys.length) {
    var key = keys.pop();
    object[key] = values.pop();
}
```

*Запрещено:*

```js
var keys = ['foo', 'bar'],
    values = [23, 42],
    object = {},
    key;

while (keys.length) {
  key = keys.pop();
  object[key] = values.pop();
}
```

### Оформление массивов и объектов
Массивы стоит объявлять чере квадратные скобки, объект через фигурные соответственно.
Если массив имеет небольшое число элементов, то они должны быть объявлены на той же строке, что и открывающая скобка.
Если массив имеет большое число элементов, каждый элмент должен быть объявлен с новой строки.
При строчном перечислении элементов, необходимо делать один пробельный оступ между запятой и значением элемента.

Однако, свойства объекта следует объявлять по одному на строке. Запрещено отделять имя и значение символами табуляции, либо больше одного пробельного для ложной читабельности. Также именования следует обрамлять кавычками только в особых случаях.

*Разрешено:*

```js
var arrayOne = ['hello', 'world'];
var arrayOneBig = [
    'hello',
    'world',
    'this',
    'is',
    'github',
    'readme',
    'file'
];
var arrayTwo = {
    good: 'code',
    'is generally': 'pretty',
};
```

*Запрещено:*

```js
var a = [
  'hello', 'world'
];
var ab = ['hello','world','this','is','github','readme','file'];
var b = {"good": 'code'
        , is generally: 'pretty'
        };
```

### Операторы сравнения
В javascript имеются как строгие сравнения, так и сравнения с преобразованием типа операндов. Строгие сравнения истинны только в том случае, если **типы сравниваемых** значений являются одинаковыми. Однако, чаще используются сравнения с преобразованием типов, такой тип сравнения, перед тем как непосредственно выполнить сравнение, приводит операнды к одному типу. В случае же, абстрактного реляционного сравнения, операнды сперва преобразуются в примитивы, затем приводятся к одному типу, и только после этого сравниваются.

При использовании сравнения с преобразованием типов, следует быть крайне осторожным, так как это может привести к непредвиденным проблемам, связанным с особенностями конвертации различных типов (см. параграф "Использование операторов равенства").

##### Особенности сравнений:
* Две строки строго равны только в том случае, если они имеют одинаковую длину, и те же символы в одинаковой последовательности и соответствующих позициях.
* Два числа строго равны в том случае, если они численно равны. NaN не равно ничему, в том числе и NaN. Нули с положительным и отрицательным знаком равны.
* Два логических значения (boolean) равны только в том случае, если они оба истинны (true) или ложны (false).
* Два различных объекта никогда не равны как в строгих, так и в абстрактных сравнениях.
* Сравнение объекта истинно лишь в том случае, если оба операнда ссылаются на один и тот же объект в памяти.
* Виды null и undefined равны себе как в строгом сравнении, так и в абстрактном.

**При использовании сравнения с преобразованием типов, следует быть крайне осторожным, так как это может привести к непредвиденным проблемам, связанным с особенностями конвертации различных типов (см. параграф "Использование операторов равенства").**

В данном случае **желательно** использовать строгий оператор сравнения.

*Желательно:*

```js
var foobar = 0;
if (foobar !== '') {
    console.log('winning');
}

```

*Не желательно:*

```js
var foobar = 0;
if (foobar == '') {
    console.log('losing');
}
```

### Использование описательных условий
Результат любого не тривиального (а иногда даже очень странного) условия или выражения должен быть присвоен переменной либо функции с описательным именованием:

*Разрешено:*

```js
var isValidPassword = password.length >= 4 && /^(?=.*\d).{4,}$/.test(password);

if (isValidPassword) {
    console.log('winning');
}
```

*Запрещено:*

```js
if (password.length >= 4 && /^(?=.*\d).{4,}$/.test(password)) {
    console.log('losing');
}
```

### Цепочка методов
Если небоходимо использовать цепочные методы, то каждый из них должен быть:
* один метод но строке
* отбить слева 4 пробельными отступами, чтобы можно были легко визуально опрделить данный тип методов

*Разрешено:*

```js
User
    .findOne({ name: 'foo' })
    .populate('bar')
    .exec(function(err, user) {
        return true;
    });
````

*Запрещено:*

```js
User
.findOne({ name: 'foo' })
.populate('bar')
.exec(function(err, user) {
  return true;
});

User.findOne({ name: 'foo' })
  .populate('bar')
  .exec(function(err, user) {
    return true;
  });

User.findOne({ name: 'foo' }).populate('bar')
.exec(function(err, user) {
  return true;
});

User.findOne({ name: 'foo' }).populate('bar')
  .exec(function(err, user) {
    return true;
  });
````
